# Windows 系统安装

## 前言

系统安装需要了解一些基本规则。

### 移动硬盘格式

| **FAT32**(兼容性好)                                                                  | **ExFAT**兼容性好 | **NTFS**     | **HFS+**   | **APFS**   |
| ------------------------------------------------------------------------------------ | ----------------- | ------------ | ---------- | ---------- |
| 适合闪存<br>适合老旧主板和老旧电脑识别<br>单个分区不能超过32G<br>单个文件不能超过4GB | 适合闪存          | 适合 Windows | 适合 MacOS | 适合 MacOS |
| U盘/SD卡                                                                             | U盘/SD卡/移动SSD  | 机械硬盘     | 机械硬盘   | SSD        |

### 开机引导方式 & 磁盘存储数据的结构

对应关系如下：

| **开机引导方式**            | **磁盘存储数据的结构** |
| --------------------------- | ---------------------- |
| legacy 引导（适合老旧主板） | MBR 分区               |
| UEFI 引导                   | GPT 分区               |

当对应关系不对时，可能出现如下问题：

<span style="color: red">Windows 无法安装到这个磁盘。选中的磁盘具有MER分区表。在EFI 系统上，Windows只能安装到GFT磁盘。</span>

解决方案1：

老电脑：legacy 引导启动，匹配 MBR 磁盘。

解决方案2：

> select disk 0 中的 0 代指的电脑磁盘，注意区分U盘和电脑磁盘。

1. 进入 BIOS 更改引导方式为 UEFI（通常在 BOOT 选项里面修改）
2. **第三方工具**：如分区工具，将 MBR 切换成 GPT，用来匹配UEFI引导。
3. **命令行的方式**：将 MBR 切换成 GPT，用来匹配UEFI引导。
   - `Shift + F10` 打开命令提示符
   - 执行 `diskpart`
   - 执行 `list disk`，将会列出电脑的所有磁盘
   - 执行  `select disk 0`
   - 执行  `clean`，清空选的磁盘的全部分区。
   - 执行 `convert gpt`，此时磁盘就切换成 GPT 格式了
      - 同理：如果是 `convert MBR` ，磁盘就切换成 MBR 格式了
   - 执行两次 `exit` 即可退出。

## 实操步骤

### 制作 PE 启动盘

1. 准备足够大小的 U 盘。（至少8G）
2. 选择对应版本后格式化 U 盘，会有两个分区。
   1. EFI 分区：PE 本身所在的区，不要动！该区相当于小型的操作系统。
   2. 空白分区：可当作U盘使用即可，可以放置 windows 镜像文件等……

### BIOS 设置

1. 备份好资料后重启电脑，进入 BIOS 界面。
2. 设置 U 盘为启动项，保存设置重启。

### 安装系统

1. 进入 PE 界面。
2. 使用分区工具（如：DiskGenius）进行磁盘分区，固态硬盘设置 4k 对齐。（小心不要格式化 U 盘）

### 跳过联网

若开机时没有跳过联网选项，如何跳过联网步骤？

1. `Shift + F10` 或者 `Shift + Fn + F10` 唤出命令行。
2. 命令行输入：`oobe\bypassnro`，完成后机器会重启，此时就会有跳过联网的步骤了。

## Windows 激活工具

- <https://github.com/YerongAI/Office-Tool>
- <https://github.com/TGSAN/CMWTAT_Digital_Edition>
- <https://github.com/zbezj/HEU_KMS_Activator>
